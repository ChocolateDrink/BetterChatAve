// ==UserScript==
// @name         Better Chat Avenue
// @version      22/2/2025
// @description  tampermonkey script to make chatting sites like chat avenue abit better
// @author       warmchocolatedrink
// @match        *://*.chat-avenue.com/*
// @match        *://*.teen-chat.org/*
// @run-at       document-start
// ==/UserScript==

(()=>{"use strict";var t={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,s=0;s<e.length;s++)if(e[s].identifier===t){n=s;break}return n}function s(t,s){for(var o={},r=[],a=0;a<t.length;a++){var c=t[a],d=s.base?c[0]+s.base:c[0],l=o[d]||0,u="".concat(d," ").concat(l);o[d]=l+1;var p=n(u),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var m=i(h,s);s.byIndex=a,e.splice(a,0,{identifier:u,updater:m,references:1})}r.push(u)}return r}function i(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=s(t=t||[],i=i||{});return function(t){t=t||[];for(var r=0;r<o.length;r++){var a=n(o[r]);e[a].references--}for(var c=s(t,i),d=0;d<o.length;d++){var l=n(o[d]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}o=c}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",s=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),s&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),s&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,s,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(s)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(r[c]=!0)}for(var d=0;d<t.length;d++){var l=[].concat(t[d]);s&&r[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},588:(t,e,n)=>{n.d(e,{A:()=>a});var s=n(601),i=n.n(s),o=n(314),r=n.n(o)()(i());r.push([t.id,':root {\n\t--border: 1.5px solid rgba(0, 221, 255, 0.9);\n}\n\n.gui-main {\n\tposition: absolute;\n\twidth: 400px;\n\theight: 320px;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\tborder-radius: 12px;\n\tborder: var(--border);\n\tbackground: rgba(30, 30, 30, 0.85);\n\tbackdrop-filter: blur(8px);\n\tbox-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);\n\toverflow: hidden;\n\ttransition: opacity 0.15s ease;\n\tz-index: 99999;\n}\n\n.gui-title-bar {\n\tpadding: 12px 16px;\n\tbackground: rgba(40, 40, 40, 0.9);\n\tborder-bottom: 1px solid rgba(255, 255, 255, 0.1);\n\tuser-select: none;\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n.gui-title {\n\tcolor: #fff;\n\tfont-size: 14px;\n}\n\n.gui-control-btns-bar {\n\tdisplay: flex;\n\tgap: 8px;\n}\n\n.gui-control-btn {\n\tcursor: pointer;\n\tfont-size: 18px;\n\tcolor: #fff;\n\tbackground: none;\n\tborder: none;\n\tpadding: 0 6px;\n\topacity: 0.8;\n\ttransition: opacity 0.2s;\n}\n\n.gui-control-btn:hover {\n\topacity: 1;\n}\n\n.gui-control-btn:focus {\n\toutline: none;\n}\n\n.gui-content {\n\tpadding: 16px;\n\theight: calc(100% - 45px);\n\toverflow-y: auto;\n\tscrollbar-width: none;\n\tcolor: #fff;\n\t-webkit-scrollbar: none;\n}\n\n.gui-main-btn {\n\tbackground: rgba(60, 60, 60, 0.8);\n\tborder: var(--border);\n\tborder-radius: 6px;\n\tpadding: 8px 16px;\n\tmargin: 4px;\n\tcursor: pointer;\n\tcolor: #fff;\n\ttransition: all 0.2s ease;\n}\n\n.gui-main-btn:hover {\n\tbackground: rgba(80, 80, 80, 0.8);\n\ttransform: translateY(-1px);\n}\n\n.gui-main-toggle-container {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin: 8px 4px;\n\tcolor: #fff;\n}\n\n.gui-main-toggle-switch {\n\tposition: relative;\n\tdisplay: inline-block;\n\twidth: 50px;\n\theight: 24px;\n\tmargin-right: 8px;\n}\n\n.gui-main-toggle-switch input {\n\topacity: 0;\n\twidth: 0;\n\theight: 0;\n}\n\n.gui-main-toggle-slider {\n\tposition: absolute;\n\tcursor: pointer;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: rgba(60, 60, 60, 0.8);\n\ttransition: .4s;\n\tborder-radius: 24px;\n\tborder: var(--border);\n}\n\n.gui-main-toggle-slider:before {\n\tposition: absolute;\n\tcontent: "";\n\theight: 16px;\n\twidth: 16px;\n\tleft: 4px;\n\tbottom: 4px;\n\tbackground-color: white;\n\ttransition: .4s;\n\tborder-radius: 50%;\n}\n\ninput:checked + .gui-main-toggle-slider {\n\tbackground-color: #385076;\n}\n  \ninput:checked + .gui-main-toggle-slider:before {\n\ttransform: translateX(26px);\n}\n\n.gui-notif {\n\tposition: fixed;\n\ttop: 20px;\n\tright: 20px;\n\tbackground: rgba(40, 40, 40, 0.95);\n\tcolor: #fff;\n\tpadding: 12px 20px;\n\tborder-radius: 8px;\n\tborder: var(--border);\n\tbox-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n\tfont-size: 14px;\n\topacity: 0;\n\ttransform: translateY(-20px);\n\ttransition: all 0.3s ease;\n\tbackdrop-filter: blur(8px);\n\tz-index: 99999;\n\tcursor: pointer;\n\tmax-width: 300px;\n\tword-wrap: break-word;\n}\n\n.gui-notif.show {\n\topacity: 1;\n\ttransform: translateY(0);\n}\n\n.gui-notif:hover {\n\tbackground: rgba(50, 50, 50, 0.95);\n}',""]);const a=r},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,n){var s=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,i&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function n(s){var i=e[s];if(void 0!==i)return i.exports;var o=e[s]={id:s,exports:{}};return t[s](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var s=n(72),i=n.n(s),o=n(825),r=n.n(o),a=n(659),c=n.n(a),d=n(56),l=n.n(d),u=n(540),p=n.n(u),h=n(113),m=n.n(h),g=n(588),f={};f.styleTagTransform=m(),f.setAttributes=l(),f.insert=c().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=p();i()(g.A,f);g.A&&g.A.locals&&g.A.locals;const b={state:{},create(t,e,n){const s=document.createElement(t);return e&&(s.className="gui-"+e),n&&(s.textContent=n),s},init(){this.state.main=this.create("div","main"),this.state.titleBar=this.create("div","title-bar"),this.state.title=this.create("div","title","Better Chat Avenue");const t=this.create("div","control-btns-bar"),e=this.create("button","control-btn","-");e.onclick=()=>this.minimize();const n=this.create("button","control-btn","x");n.onclick=()=>this.deinit(),t.appendChild(e),t.appendChild(n),this.state.titleBar.appendChild(this.state.title),this.state.titleBar.appendChild(t),this.state.content=this.create("div","content"),this.state.main.appendChild(this.state.titleBar),this.state.main.appendChild(this.state.content),document.body.appendChild(this.state.main),document.addEventListener("keydown",(t=>{"Insert"===t.key&&("none"===this.state.main.style.display?(this.state.main.style.display="block",setTimeout((()=>{this.state.main.style.opacity="1"}),50)):(this.state.main.style.opacity="0",setTimeout((()=>{this.state.main.style.display="none"}),50)))})),this.dragify(this.state.titleBar),this.notif("you can click INSERT to toggle visibility of the ui",15)},deinit(){this.state.main.style.opacity="0",setTimeout((()=>{this.state.main.remove()}),300)},minimize(){this.state.main.style.opacity="0",setTimeout((()=>{this.state.main.style.display="none"}),300)},dragify(t){let e=!1,n={X:0,Y:0},s={X:0,Y:0},i={X:0,Y:0};t.addEventListener("mousedown",(n=>{if(n.target!==t&&!n.target.closest(".gui-title-bar"))return;const i=window.getComputedStyle(this.state.main).transform,o="none"===i?new DOMMatrix:new DOMMatrix(i);s.X=n.clientX-o.m41,s.Y=n.clientY-o.m42,e=!0})),document.addEventListener("mouseup",(()=>{e=!1})),document.addEventListener("mousemove",(t=>{e&&(t.preventDefault(),n.X=t.clientX-s.X,n.Y=t.clientY-s.Y,i.X=n.X,i.Y=n.Y,this.state.main.style.transform=`translate(${n.X}px, ${n.Y}px)`)}))},notif(t="",e=2,n=null){const s=this.create("div","notif",t);return s.addEventListener("click",(()=>{s.classList.remove("show"),setTimeout((()=>s.remove()),300),"function"==typeof n&&destroyCallback(),s.timeout&&clearTimeout(s.timeout)})),document.body.appendChild(s),setTimeout((()=>s.classList.add("show")),100),-1!==e&&(s.timeout=setTimeout((()=>{s.classList.remove("show"),setTimeout((()=>s.remove()),300)}),1e3*e)),s},addButton(t,e){const n=this.create("button","main-btn",t);return n.addEventListener("click",e),this.state.content.appendChild(n),n},addToggle(t,e){const n=this.create("div","main-toggle-container"),s=this.create("span","blank00",t),i=this.create("label","main-toggle-switch"),o=this.create("input");o.type="checkbox",o.addEventListener("change",(t=>e(t.target.checked)));const r=this.create("span","main-toggle-slider");return i.appendChild(o),i.appendChild(r),n.appendChild(i),n.appendChild(s),this.state.content.appendChild(n),n}},v=JSON.parse('["💦","🍆","🆓","💋","Ⓜ️","🅰️","disc","cord","dis","d i s","dizc","dc","tele","t e l e","t el","telg","tg","gram","ses","s e s","se s","w hatsapp","sc","s c","str","s t r","st r","s tr","$+ R","$ + R","$+R","$ +R","sel","s e l","s31","tra","t r a","tr a","buy","price","preview","ib","i b","whr by","w h e","w h r","wh er","Wherby","wereby","whe re","where by","exchang","f9","f10","f11","f12","f 9","f 10","f 11","f 12","m9","m10","m11","m12","m 9","m 10","m 11","m 12","teen","t e e n","t33n","link","cam","c a m","ca m","c am","me g","m3g","mga","mega","s naps","sna!p"]'),y={badWords:[],sesRegex:/^[0-9a-fA-F]{66}$/,filRegex:/[`'/.,:;_-]/g,init(){this.badWords=v},hasSessToken(t){return t.split(" ").some((t=>this.sesRegex.test(t)))},hasBypassedText:t=>[...t].some((t=>{const e=t.codePointAt(0);return e>=119808&&e<=120831})),hasBadWord(t){const e=this.badWords.find((e=>t.includes(" "+e)));if(e)return e;const n=this.badWords.find((e=>t.includes(e+" ")));return n||(this.hasSessToken(t)?"sess token":this.hasBypassedText(t)?"bypassed text":null)}},x={hooked:{},hookNotifis(t){if(t)return this.hooked.callSuccess=callSuccess,void(callSuccess=()=>{});this.hooked.callSuccess&&(callSuccess=this.hooked.callSuccess,delete this.hooked.callSuccess)},hookCloseRight(){let t=closeRight;closeRight=()=>{prepareRight(0),userReload(1),closeRight=t,t=null}}};class w{constructor(t,e,n){this.name=t,this.type=e,this.enabled=!1,this.bind=n,"Button"===e?this.ui=b.addButton(t,this.onClicked.bind(this)):"Toggle"===e&&(this.ui=b.addToggle(t,this.toggle.bind(this)))}onEnabled(){}onDisabled(){}onClicked(){}enable(){this.enabled=!0,this.onEnabled()}disable(){this.enabled=!1,this.onDisabled()}toggle(t){t?this.enable():this.disable()}}class k extends w{constructor(){super("Search By Country","Button")}onClicked(){const t=prompt('country code to search, example: "sg" for singapore');t&&(prepareRight(0),$.post("system/panel/user_list.php",{},(function(e){$("#chat_right_data").html(e),firstPanel="",document.querySelectorAll("#chat_right_data .user_item").forEach((e=>{e.getAttribute("data-country")!==t.toUpperCase()&&e.remove()})),x.hookCloseRight()})))}}class C extends w{constructor(){super("Chat Filter Bypass","Toggle")}}class S extends w{constructor(){super("Remove Spam Messages","Toggle")}}class T extends w{constructor(){super("Remove Long Messages","Toggle")}}class L extends w{constructor(){super("Block Spammers","Toggle")}}class E extends w{constructor(){super("Log Spam Messages","Toggle")}}class R extends w{constructor(){super("Disable Success Notification","Toggle")}onEnabled(){x.hookNotifis(!0)}onDisabled(){x.hookNotifis(!1)}}class B extends w{constructor(){super("Close DMS","Bind","P")}onClicked(){togglePrivate(1)}}class M extends w{constructor(){super("Dm Swap","Bind","L")}onClicked(){"none"===document.getElementById("private_menu").style.display&&getPrivate(),setTimeout((()=>{const t=document.querySelector(".fmenu_name.gprivate");t&&t.click()}),460)}}class _ extends w{constructor(){super("Quick Block","Bind","B")}onClicked(){if(0===currentPrivate)return;ignoreThisUser();const t=document.getElementById("private_close");t&&t.click()}}const A={modules:{},shiftDown:!1,add(t){this.modules[t.name]=t},init(){y.init(),window.bca.filter=y,this.add(new k),this.add(new C),this.add(new S),this.add(new T),this.add(new L),this.add(new E),this.add(new R),this.add(new B),this.add(new M),this.add(new _),this.initChatHooks(),this.initSpamFilter(),this.initKeybinds()},initChatHooks(){const t=XMLHttpRequest.prototype.open,e=XMLHttpRequest.prototype.send,n=this;XMLHttpRequest.prototype.open=function(e,n){return this.hookable=n.includes("chat_process.php")||n.includes("private_process.php"),t.apply(this,arguments)},XMLHttpRequest.prototype.send=function(t){if(!this.hookable||!t||!n.modules["Chat Filter Bypass"].enabled)return e.apply(this,[t]);const s=new URLSearchParams(t);let i=s.get("content");return i?(i=i.split(" ").map((t=>t.length>=3?t.split("").join("‎"):t)).join(" "),s.set("content",i),t=s.toString(),e.apply(this,[t])):e.apply(this,[t])}},initSpamFilter(){const t=document.getElementById("chat_logs_container");this.observer=new MutationObserver((t=>{for(const e of t)"childList"===e.type&&e.addedNodes.forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE&&"LI"===t.tagName){const e=t.querySelector(".chat_message");if(!e)return;const n=t.querySelector(".avtrig.avs_menu.chat_avatar"),s=n?n.getAttribute("data-id"):null,i=e.textContent.trim().toLowerCase().replace(y.filRegex,""),o=y.hasBadWord(i);if(this.modules["Remove Spam Messages"].enabled&&o)return t.remove(),this.modules["Log Spam Messages"].enabled&&console.log(`removed: "${i}" due to: "${o}"`),void(this.modules["Block Spammers"].enabled&&s&&ignoreUser(parseInt(s)));if(this.modules["Remove Long Messages"].enabled&&i.length>=200)return t.remove(),this.modules["Log Spam Messages"].enabled&&console.log(`removed: "${i.slice(0,50)}..." due to having more than 200 characters (${i.length})`),void(this.modules["Block Spammers"].enabled&&s&&ignoreUser(parseInt(s)))}}))})),this.observer.observe(t,{childList:!0,subtree:!0})},initKeybinds(){document.addEventListener("keyup",(t=>{"ShiftRight"!==t.code&&(this.shiftDown=!1)})),document.addEventListener("keydown",(t=>{"ShiftRight"===t.code&&(this.shiftDown=!0)})),document.addEventListener("keydown",(t=>{for(const e in this.modules){const n=this.modules[e];if("Bind"!==n.type)continue;const s=n.bind?.length>1?n.bind:"Key".concat(n.bind);t.code===s&&this.shiftDown&&n.onClicked()}}))}};new class{constructor(){window.bca={},this.init()}init(){b.init(),A.init(),window.bca.modules=A.modules,window.bca.gui=b}}})();
